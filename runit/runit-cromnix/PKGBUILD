# Maintainer:

pkgname=runit-cromnix
pkgver=20170814
pkgrel=3
pkgdesc='Runit initscripts for Cromnix'
conflicts=('runit-cromnix-openrc')
provides=('runit-init')
url='https://github.com/cromnix/runit-cromnix/'
license=('custom:CC0')
arch=('i686' 'x86_64')
install='runit-cromnix.install'
depends=('procps-ng' 'gawk' 'sh')
source=("${pkgname}-${pkgver}.tar.gz::https://github.com/cromnix/runit-cromnix/archive/${pkgver}.tar.gz")
backup=('etc/runit/rc.conf'
        'etc/runit/rc.local'
        'etc/runit/rc.shutdown')
sha256sums=('97803eb5bc1f82fafb025a67aa339bd934c330690c0d22780f10656c459350e4')

# todo: change gawk depends to awk later

build() {
	cd "${srcdir}/${pkgname}-${pkgver}"
	make
}

package() {
	cd "${srcdir}/${pkgname}-${pkgver}"

	make DESTDIR="${pkgdir}" PREFIX="/usr" install

	# License
	mkdir -p "${pkgdir}"/usr/share/licenses/runit-cromnix
	sed -n '/To the extent/,/0/p' README.md > "${pkgdir}"/usr/share/licenses/runit-cromnix/LICENSE
}
